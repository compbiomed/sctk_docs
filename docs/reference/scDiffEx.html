<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Perform differential expression analysis on a SCtkExperiment object — scDiffEx • singleCellTK</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Perform differential expression analysis on a SCtkExperiment object — scDiffEx" />
<meta property="og:description" content="Perform differential expression analysis on a SCtkExperiment object" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">singleCellTK</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.7.5</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../articles/introduction_to_SCTK.html">Introduction to SingleCellToolKit</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Command Line Analysis
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/import_scRNAseq_data_as_SCE.html">Import data into SCTK</a>
    </li>
    <li>
      <a href="../articles/run_qc.html">Quality Control</a>
    </li>
    <li>
      <a href="../articles/normalization.html">Normalization</a>
    </li>
    <li>
      <a href="../articles/batch_correction.html">Batch Correction</a>
    </li>
    <li>
      <a href="../articles/variability.html">Variability</a>
    </li>
    <li>
      <a href="../articles/feature_selection.html">Feature Selection</a>
    </li>
    <li>
      <a href="../articles/differential_expression.html">Differential Expression</a>
    </li>
    <li>
      <a href="../articles/visualize_results.html">Visualize Results</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/compbiomed/singleCellTK">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Perform differential expression analysis on a SCtkExperiment object</h1>
    <small class="dont-index">Source: <a href='https://github.com/compbiomed/singleCellTK/blob/master/R/scDiffEx.R'><code>R/scDiffEx.R</code></a></small>
    <div class="hidden name"><code>scDiffEx.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Perform differential expression analysis on a SCtkExperiment object</p>
    </div>

    <pre class="usage"><span class='fu'>scDiffEx</span>(
  <span class='no'>inSCE</span>,
  <span class='kw'>useAssay</span> <span class='kw'>=</span> <span class='st'>"logcounts"</span>,
  <span class='no'>condition</span>,
  <span class='kw'>covariates</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>significance</span> <span class='kw'>=</span> <span class='fl'>0.05</span>,
  <span class='kw'>ntop</span> <span class='kw'>=</span> <span class='fl'>500</span>,
  <span class='kw'>usesig</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='no'>diffexmethod</span>,
  <span class='kw'>levelofinterest</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>analysisType</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>controlLevel</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>adjust</span> <span class='kw'>=</span> <span class='st'>"fdr"</span>
)

<span class='fu'>scDiffExDESeq2</span>(
  <span class='no'>inSCE</span>,
  <span class='kw'>useAssay</span> <span class='kw'>=</span> <span class='st'>"counts"</span>,
  <span class='no'>condition</span>,
  <span class='kw'>analysisType</span> <span class='kw'>=</span> <span class='st'>"biomarker"</span>,
  <span class='kw'>levelofinterest</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>controlLevel</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>covariates</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>adjust</span> <span class='kw'>=</span> <span class='st'>"fdr"</span>
)

<span class='fu'>scDiffExlimma</span>(
  <span class='no'>inSCE</span>,
  <span class='kw'>useAssay</span> <span class='kw'>=</span> <span class='st'>"logcounts"</span>,
  <span class='no'>condition</span>,
  <span class='kw'>analysisType</span> <span class='kw'>=</span> <span class='st'>"biomarker"</span>,
  <span class='kw'>levelofinterest</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>covariates</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>adjust</span> <span class='kw'>=</span> <span class='st'>"fdr"</span>
)

<span class='fu'>scDiffExANOVA</span>(
  <span class='no'>inSCE</span>,
  <span class='kw'>useAssay</span> <span class='kw'>=</span> <span class='st'>"logcounts"</span>,
  <span class='no'>condition</span>,
  <span class='kw'>covariates</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>adjust</span> <span class='kw'>=</span> <span class='st'>"fdr"</span>
)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>inSCE</th>
      <td><p>Input SCtkExperiment object. Required</p></td>
    </tr>
    <tr>
      <th>useAssay</th>
      <td><p>Indicate which assay to use. Default is "logcounts" for limma
and ANOVA, and "counts" for DESeq2.</p></td>
    </tr>
    <tr>
      <th>condition</th>
      <td><p>The name of the condition to use for differential
expression. Must be a name of a column from colData that contains at least
two labels. Required</p></td>
    </tr>
    <tr>
      <th>covariates</th>
      <td><p>Additional covariates to add to the model. Default is NULL</p></td>
    </tr>
    <tr>
      <th>significance</th>
      <td><p>FDR corrected significance cutoff for differentially
expressed genes. Required</p></td>
    </tr>
    <tr>
      <th>ntop</th>
      <td><p>Number of top differentially expressed genes to display in the
heatmap. Required</p></td>
    </tr>
    <tr>
      <th>usesig</th>
      <td><p>If TRUE, only display genes that meet the significance cutoff,
up to ntop genes. Required</p></td>
    </tr>
    <tr>
      <th>diffexmethod</th>
      <td><p>The method for performing differential expression
analysis. Available options are DESeq2, limma, and ANOVA. Required</p></td>
    </tr>
    <tr>
      <th>levelofinterest</th>
      <td><p>If the condition has more than two labels,
levelofinterest should contain one factor for condition. The differential
expression results will use levelofinterest depending on the analysisType
parameter.</p></td>
    </tr>
    <tr>
      <th>analysisType</th>
      <td><p>For conditions with more than two levels, limma and
DESeq2 can be run using multiple methods. For DESeq2, choose "biomarker" to
compare the levelofinterest to all other samples. Choose "contrast" to
compare the levelofinterest to a controlLevel (see below). Choose
"fullreduced" to perform DESeq2 in LRT mode. For limma, Choose "biomarker" to
compare the levelofinterest to all other samples. Choose "coef" to select a
coefficient of interest with levelofinterest (see below). Choose "allcoef" to
test if any coefficient is different from zero.</p></td>
    </tr>
    <tr>
      <th>controlLevel</th>
      <td><p>If the condition has more than two labels, controlLevel
should contain one factor from condition to use as the control.</p></td>
    </tr>
    <tr>
      <th>adjust</th>
      <td><p>Method for p-value correction. See options in p.adjust().
The default is fdr.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A data frame of gene names and adjusted p-values</p>
    <h2 class="hasAnchor" id="functions"><a class="anchor" href="#functions"></a>Functions</h2>

    
<ul>
<li><p><code>scDiffExDESeq2</code>: Perform differential expression analysis with DESeq2</p></li>
<li><p><code>scDiffExlimma</code>: Perform differential expression analysis with limma</p></li>
<li><p><code>scDiffExANOVA</code>: Perform differential expression analysis with ANOVA</p></li>
</ul>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span>(<span class='st'>"mouseBrainSubsetSCE"</span>)
<span class='no'>res</span> <span class='kw'>&lt;-</span> <span class='fu'>scDiffEx</span>(<span class='no'>mouseBrainSubsetSCE</span>,
                <span class='kw'>useAssay</span> <span class='kw'>=</span> <span class='st'>"logcounts"</span>,
                <span class='st'>"level1class"</span>,
                <span class='kw'>diffexmethod</span> <span class='kw'>=</span> <span class='st'>"limma"</span>)</div><div class='output co'>#&gt; <span class='warning'>Warning: Zero sample variances detected, have been offset away from zero</span></div><div class='output co'>#&gt; <span class='message'>Removing intercept from test coefficients</span></div><div class='input'>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span>(<span class='st'>"mouseBrainSubsetSCE"</span>)
<span class='co'>#sort first 100 expressed genes</span>
<span class='no'>ord</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>rownames</a></span>(<span class='no'>mouseBrainSubsetSCE</span>)[
  <span class='fu'><a href='https://rdrr.io/r/base/order.html'>order</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/colSums.html'>rowSums</a></span>(<span class='fu'>assay</span>(<span class='no'>mouseBrainSubsetSCE</span>, <span class='st'>"counts"</span>)),
        <span class='kw'>decreasing</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)][<span class='fl'>1</span>:<span class='fl'>100</span>]
<span class='co'>#subset to those first 100 genes</span>
<span class='no'>subset</span> <span class='kw'>&lt;-</span> <span class='no'>mouseBrainSubsetSCE</span>[<span class='no'>ord</span>, ]
<span class='no'>res</span> <span class='kw'>&lt;-</span> <span class='fu'>scDiffExDESeq2</span>(<span class='no'>subset</span>, <span class='kw'>condition</span> <span class='kw'>=</span> <span class='st'>"level1class"</span>)</div><div class='output co'>#&gt; <span class='message'>estimating size factors</span></div><div class='output co'>#&gt; <span class='message'>estimating dispersions</span></div><div class='output co'>#&gt; <span class='message'>gene-wise dispersion estimates</span></div><div class='output co'>#&gt; <span class='message'>mean-dispersion relationship</span></div><div class='output co'>#&gt; <span class='message'>-- note: fitType='parametric', but the dispersion trend was not well captured by the</span>
#&gt; <span class='message'>   function: y = a/x + b, and a local regression fit was automatically substituted.</span>
#&gt; <span class='message'>   specify fitType='local' or 'mean' to avoid this message next time.</span></div><div class='output co'>#&gt; <span class='message'>final dispersion estimates</span></div><div class='output co'>#&gt; <span class='message'>fitting model and testing</span></div><div class='input'>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span>(<span class='st'>"mouseBrainSubsetSCE"</span>)
<span class='no'>res</span> <span class='kw'>&lt;-</span> <span class='fu'>scDiffExlimma</span>(<span class='no'>mouseBrainSubsetSCE</span>, <span class='kw'>condition</span> <span class='kw'>=</span> <span class='st'>"level1class"</span>)</div><div class='output co'>#&gt; <span class='warning'>Warning: Zero sample variances detected, have been offset away from zero</span></div><div class='output co'>#&gt; <span class='message'>Removing intercept from test coefficients</span></div><div class='input'>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span>(<span class='st'>"mouseBrainSubsetSCE"</span>)
<span class='no'>res</span> <span class='kw'>&lt;-</span> <span class='fu'>scDiffExANOVA</span>(<span class='no'>mouseBrainSubsetSCE</span>, <span class='kw'>condition</span> <span class='kw'>=</span> <span class='st'>"level1class"</span>)</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Joshua D. Campbell, David Jenkins, Tyler Faits, Mohammed Muzamil Khan, Zhe Wang, Emma Briars, Sebastian Carrasco Pro, W. Evan Johnson, Yusuke Koga, Shruthi Bandyadka, Anastasia Leshchyk, Rui Hong.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


