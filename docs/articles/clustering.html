<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Clustering • singleCellTK</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Clustering">
<meta property="og:description" content="singleCellTK">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">singleCellTK</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.9.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/introduction_to_SCTK.html">General Workflow</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Shell Command Line Analysis
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/run_qc.html">Quality Control</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    R Console Analysis
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/import_scRNAseq_data_as_SCE.html">Import data into SCTK</a>
    </li>
    <li>
      <a href="../articles/run_qc.html">Quality Control</a>
    </li>
    <li>
      <a href="../articles/normalization.html">Normalization</a>
    </li>
    <li>
      <a href="../articles/batch_correction.html">Batch Correction</a>
    </li>
    <li>
      <a href="../articles/variability.html">Variability</a>
    </li>
    <li>
      <a href="../articles/feature_selection.html">Feature Selection</a>
    </li>
    <li>
      <a href="../articles/differential_expression.html">Differential Expression</a>
    </li>
    <li>
      <a href="../articles/find_marker.html">Find Marker via DE</a>
    </li>
    <li>
      <a href="../articles/visualize_results.html">Visualize Results</a>
    </li>
    <li>
      <a href="../articles/heatmap.html">Heatmap Visualization</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Shiny UI Analysis
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/ui_batch_correction.html">Batch Correction</a>
    </li>
    <li>
      <a href="../articles/ui_clustering.html">Clustering</a>
    </li>
    <li>
      <a href="../articles/ui_differential_expression.html">Differential Expression</a>
    </li>
    <li>
      <a href="../articles/ui_find_marker.html">Find Marker</a>
    </li>
    <li>
      <a href="../articles/ui_heatmap.html">Generic Heatmap</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/compbiomed/singleCellTK">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="clustering_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Clustering</h1>
                        <h4 class="author">Yichen Wang</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/compbiomed/singleCellTK/blob/master/vignettes/clustering.Rmd"><code>vignettes/clustering.Rmd</code></a></small>
      <div class="hidden name"><code>clustering.Rmd</code></div>

    </div>

    
    
<div id="introduction" class="section level2">
<h2 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h2>
<p>For this section, we provide wrappers of three methods, listed in the table below. All functions takes an input <a href="https://rdrr.io/bioc/SingleCellExperiment/man/SingleCellExperiment.html"><code>SingleCellExperiment</code></a> (SCE) object and other settings as arguments and returns the same SCE object with results updated in <code>colData</code>.</p>
<table class="table">
<colgroup>
<col width="30%">
<col width="20%">
<col width="20%">
<col width="30%">
</colgroup>
<thead><tr class="header">
<th align="center">Method</th>
<th align="left">Dependency</th>
<th align="left">Citation</th>
<th align="center">Function</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center">Scran SNN</td>
<td align="left">
<code>scran</code>, <code>igraph</code>
</td>
<td align="left">Aaron Lun and Jonathan Griffiths, 2016. Gabor Csardi and Tamas Nepusz, 2006.</td>
<td align="center"><code><a href="../reference/runScranSNN.html">runScranSNN()</a></code></td>
</tr>
<tr class="even">
<td align="center">K-Means</td>
<td align="left"><code>stats</code></td>
<td align="left">Forgy, E. W., 1965. Hartigan, J. A. and Wong, M. A., 1979. Lloyd, S. P., 1957. MacQueen, J., 1967.</td>
<td align="center"><code><a href="../reference/runKMeans.html">runKMeans()</a></code></td>
</tr>
<tr class="odd">
<td align="center">Seurat</td>
<td align="left"><code>Seurat</code></td>
<td align="left">Michael Love and et al., 2014</td>
<td align="center"><code><a href="../reference/seuratFindClusters.html">seuratFindClusters()</a></code></td>
</tr>
</tbody>
</table>
</div>
<div id="workflow" class="section level2">
<h2 class="hasAnchor">
<a href="#workflow" class="anchor"></a>Workflow</h2>
<p>The clustering methods listed in the table above can be easily applied to any preprocessed SCE object. Meanwhile, there are other types of clustering methods supported by SCTK, but usually dependent to a curated workflow, such as <a href="https://rdrr.io/bioc/celda/"><code>celda</code></a>. Here we present the usage of the three functions only.</p>
<div id="parameters" class="section level3">
<h3 class="hasAnchor">
<a href="#parameters" class="anchor"></a>Parameters</h3>
<p>For each of the three functions, the common things are:</p>
<ul>
<li>The input SCE object - <code>inSCE</code>.</li>
<li>The <code>colData</code> column name to save the cluster labels - <code>clusterName</code>
</li>
<li>The specific algorithm type supported by the dependency - <code>algorithm</code>
</li>
</ul>
<p>As for another essential parameter, the data matrix used for running the algorithm is a must. Here, users should notice that:</p>
<ul>
<li>For <code><a href="../reference/runKMeans.html">runKMeans()</a></code>, only a dimension reduction is acceptable. Users need to use <code>useReducedDim</code> to pass the argument.</li>
<li>For <code><a href="../reference/runScranSNN.html">runScranSNN()</a></code>, either a feature expression matrix or a dimension reduction is acceptable. Users need to use <code>useAssay</code> for a full-sized expression data (<code>assay</code>), <code>useAltExp</code> and <code>altExpAssay</code> for a subsetted expression data (<code>altExp</code>), or <code>useReducedDim</code> for a dimension reduction.</li>
<li>For <code><a href="../reference/seuratFindClusters.html">seuratFindClusters()</a></code>, it is included within the Seurat Curated Workflow, yet usable as an independent function. However, it will be complicated to use this way. It is recommended to invoke the Seurat clustering functionality in the <a href="ui_clustering.html#seurat">UI</a> since it is automated there. We will still present the complicated workflow later.</li>
</ul>
<p>Other parameters are method specific, please refer to the function manual pages for the detail.</p>
</div>
<div id="example-on-each" class="section level3">
<h3 class="hasAnchor">
<a href="#example-on-each" class="anchor"></a>Example on Each</h3>
<div id="preprocessing" class="section level4">
<h4 class="hasAnchor">
<a href="#preprocessing" class="anchor"></a>Preprocessing</h4>
<p>To demonstrate a simple and clear example, here we use the “PBMC-3k” dataset from “10X” which can be easily imported with SCTK functions. The preprocessing only includes necessary steps before getting cluster labels (i.e. QC and filtering are excluded).</p>
<div class="sourceCode" id="cb1"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">singleCellTK</span>)
<span class="no">pbmc3k</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/importExampleData.html">importExampleData</a></span>(<span class="st">"pbmc3k"</span>)
<span class="no">pbmc3k</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/scater_logNormCounts.html">scater_logNormCounts</a></span>(<span class="no">pbmc3k</span>, <span class="st">"logcounts"</span>)
<span class="co"># Go through the Seurat curated workflow to get basic scaled assay and dimension reduction</span>
<span class="no">pbmc3k</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/seuratNormalizeData.html">seuratNormalizeData</a></span>(<span class="kw">inSCE</span> <span class="kw">=</span> <span class="no">pbmc3k</span>, <span class="kw">useAssay</span> <span class="kw">=</span> <span class="st">"counts"</span>)
<span class="no">pbmc3k</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/seuratFindHVG.html">seuratFindHVG</a></span>(<span class="kw">inSCE</span> <span class="kw">=</span> <span class="no">pbmc3k</span>, <span class="kw">useAssay</span> <span class="kw">=</span> <span class="st">"seuratNormData"</span>)
<span class="no">pbmc3k</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/seuratScaleData.html">seuratScaleData</a></span>(<span class="kw">inSCE</span> <span class="kw">=</span> <span class="no">pbmc3k</span>, <span class="kw">useAssay</span> <span class="kw">=</span> <span class="st">"seuratNormData"</span>)
<span class="no">pbmc3k</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/seuratPCA.html">seuratPCA</a></span>(<span class="kw">inSCE</span> <span class="kw">=</span> <span class="no">pbmc3k</span>, <span class="kw">useAssay</span> <span class="kw">=</span> <span class="st">"seuratScaledData"</span>)
<span class="no">pbmc3k</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/seuratRunUMAP.html">seuratRunUMAP</a></span>(<span class="no">pbmc3k</span>)
<span class="co"># Optional visualization</span>
<span class="fu"><a href="../reference/plotSCEDimReduceColData.html">plotSCEDimReduceColData</a></span>(<span class="kw">inSCE</span> <span class="kw">=</span> <span class="no">pbmc3k</span>,
                        <span class="kw">colorBy</span> <span class="kw">=</span> <span class="st">"Sample"</span>,
                        <span class="kw">reducedDimName</span> <span class="kw">=</span> <span class="st">"seuratUMAP"</span>)</pre></body></html></div>
<p><img src="clustering_files/figure-html/clst_prep-1.png" width="700" style="display: block; margin: auto;"></p>
</div>
<div id="scran-snn" class="section level4">
<h4 class="hasAnchor">
<a href="#scran-snn" class="anchor"></a>Scran SNN</h4>
<p>The method specific parameters include:</p>
<ul>
<li>
<code>k</code>, the number of nearest neighbors used to construct the graph. Smaller value indicates higher resolution and larger number of clusters.</li>
<li>
<code>nComp</code>, the number of components to use when <code>useAssay</code> or <code>useAltExp</code> is specified. WON’T work with <code>useReducedDim</code>.</li>
<li>For <code>weightType</code> and <code>algorithm</code>, users should choose from a given list of options, which can be found with <code><a href="../reference/runScranSNN.html">?runScranSNN</a></code>. For the introduction of those options, please refer to <code><a href="https://rdrr.io/pkg/scran/man/buildSNNGraph.html">scran::buildSNNGraph()</a></code> and <a href="https://rdrr.io/cran/igraph/"><code>igraph</code></a>.</li>
</ul>
<div class="sourceCode" id="cb2"><html><body><pre class="r"><span class="co"># Directly use an assay</span>
<span class="no">pbmc3k</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/runScranSNN.html">runScranSNN</a></span>(<span class="kw">inSCE</span> <span class="kw">=</span> <span class="no">pbmc3k</span>,
                      <span class="kw">useAssay</span> <span class="kw">=</span> <span class="st">"logcounts"</span>,
                      <span class="kw">k</span> <span class="kw">=</span> <span class="fl">10</span>,
                      <span class="kw">clusterName</span> <span class="kw">=</span> <span class="st">"scranSNN_logcounts"</span>)
<span class="fu"><a href="../reference/plotSCEDimReduceColData.html">plotSCEDimReduceColData</a></span>(<span class="kw">inSCE</span> <span class="kw">=</span> <span class="no">pbmc3k</span>,
                        <span class="kw">colorBy</span> <span class="kw">=</span> <span class="st">"scranSNN_logcounts"</span>,
                        <span class="kw">conditionClass</span> <span class="kw">=</span> <span class="st">"factor"</span>,
                        <span class="kw">reducedDimName</span> <span class="kw">=</span> <span class="st">"seuratUMAP"</span>)</pre></body></html></div>
<p><img src="clustering_files/figure-html/clst_ScranSNN-1.png" width="700" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb3"><html><body><pre class="r"><span class="co"># Directly use a dimension reduction</span>
<span class="no">pbmc3k</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/runScranSNN.html">runScranSNN</a></span>(<span class="kw">inSCE</span> <span class="kw">=</span> <span class="no">pbmc3k</span>,
                      <span class="kw">useReducedDim</span> <span class="kw">=</span>  <span class="st">"seuratUMAP"</span>,
                      <span class="kw">k</span> <span class="kw">=</span> <span class="fl">25</span>,
                      <span class="kw">clusterName</span> <span class="kw">=</span> <span class="st">"scranSNN_seuratUMAP"</span>)
<span class="fu"><a href="../reference/plotSCEDimReduceColData.html">plotSCEDimReduceColData</a></span>(<span class="kw">inSCE</span> <span class="kw">=</span> <span class="no">pbmc3k</span>,
                        <span class="kw">colorBy</span> <span class="kw">=</span> <span class="st">"scranSNN_seuratUMAP"</span>,
                        <span class="kw">conditionClass</span> <span class="kw">=</span> <span class="st">"factor"</span>,
                        <span class="kw">reducedDimName</span> <span class="kw">=</span> <span class="st">"seuratUMAP"</span>)</pre></body></html></div>
<p><img src="clustering_files/figure-html/clst_ScranSNN-2.png" width="700" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb4"><html><body><pre class="r"><span class="co"># Use a subset of an assay</span>
<span class="no">hvg</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/getTopHVG.html">getTopHVG</a></span>(<span class="no">pbmc3k</span>, <span class="st">"vst"</span>, <span class="kw">n</span> <span class="kw">=</span> <span class="fl">500</span>)
<span class="no">ae</span> <span class="kw">&lt;-</span> <span class="fu">SingleCellExperiment</span>(<span class="kw">assays</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">logcounts</span> <span class="kw">=</span> <span class="fu">logcounts</span>(<span class="no">pbmc3k</span>[<span class="no">hvg</span>,])))
<span class="fu">altExp</span>(<span class="no">pbmc3k</span>, <span class="st">"subset"</span>) <span class="kw">&lt;-</span> <span class="no">ae</span>
<span class="no">pbmc3k</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/runScranSNN.html">runScranSNN</a></span>(<span class="kw">inSCE</span> <span class="kw">=</span> <span class="no">pbmc3k</span>,
                      <span class="kw">useAltExp</span> <span class="kw">=</span> <span class="st">"subset"</span>,
                      <span class="kw">altExpAssay</span> <span class="kw">=</span> <span class="st">"logcounts"</span>,
                      <span class="kw">k</span> <span class="kw">=</span> <span class="fl">8</span>,
                      <span class="kw">clusterName</span> <span class="kw">=</span> <span class="st">"scranSNN_altExp"</span>)
<span class="fu"><a href="../reference/plotSCEDimReduceColData.html">plotSCEDimReduceColData</a></span>(<span class="kw">inSCE</span> <span class="kw">=</span> <span class="no">pbmc3k</span>,
                        <span class="kw">colorBy</span> <span class="kw">=</span> <span class="st">"scranSNN_altExp"</span>,
                        <span class="kw">conditionClass</span> <span class="kw">=</span> <span class="st">"factor"</span>,
                        <span class="kw">reducedDimName</span> <span class="kw">=</span> <span class="st">"seuratUMAP"</span>)</pre></body></html></div>
<p><img src="clustering_files/figure-html/clst_ScranSNN-3.png" width="700" style="display: block; margin: auto;"></p>
</div>
<div id="k-means" class="section level4">
<h4 class="hasAnchor">
<a href="#k-means" class="anchor"></a>K-Means</h4>
<p>The method specific parameters include:</p>
<ul>
<li>
<code>nCenters</code>, the number of final clusters. This is required.</li>
<li>
<code>nIter</code>, the maximum number of iterations allowed.</li>
<li>
<code>nStart</code>, the number of random sets to choose. Since K-Means is an algorithm with reasonable randomness, the function allows attempting multiple initial configurations and reports on the best one.</li>
<li>
<code>seed</code>, The seed for the random number generator.</li>
<li>For <code>algorithm</code>, users should choose from a given list of options, which can be found with <code><a href="../reference/runKMeans.html">?runKMeans</a></code>. For the introduction of those options, please refer to <code><a href="https://rdrr.io/r/stats/kmeans.html">?stats::kmeans</a></code>.</li>
</ul>
<div class="sourceCode" id="cb5"><html><body><pre class="r"><span class="no">pbmc3k</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/runKMeans.html">runKMeans</a></span>(<span class="kw">inSCE</span> <span class="kw">=</span> <span class="no">pbmc3k</span>,
                    <span class="kw">useReducedDim</span> <span class="kw">=</span> <span class="st">"seuratUMAP"</span>,
                    <span class="kw">nCenters</span> <span class="kw">=</span> <span class="fl">13</span>,
                    <span class="kw">clusterName</span> <span class="kw">=</span> <span class="st">"kmeans_cluster"</span>)
<span class="fu"><a href="../reference/plotSCEDimReduceColData.html">plotSCEDimReduceColData</a></span>(<span class="kw">inSCE</span> <span class="kw">=</span> <span class="no">pbmc3k</span>,
                        <span class="kw">colorBy</span> <span class="kw">=</span> <span class="st">"kmeans_cluster"</span>,
                        <span class="kw">conditionClass</span> <span class="kw">=</span> <span class="st">"factor"</span>,
                        <span class="kw">reducedDimName</span> <span class="kw">=</span> <span class="st">"seuratUMAP"</span>)</pre></body></html></div>
<p><img src="clustering_files/figure-html/clst_kmeans-1.png" width="700" style="display: block; margin: auto;"></p>
</div>
<div id="seurat" class="section level4">
<h4 class="hasAnchor">
<a href="#seurat" class="anchor"></a>Seurat</h4>
<p>Here we will only present the examples of using <code><a href="../reference/seuratFindClusters.html">seuratFindClusters()</a></code>. For the detail of this function or the curated workflow, please refer to <strong>WHERE?</strong></p>
<p>When users preprocessed the dataset with the Seurat Curated Workflow. The clustering can be easily fulfilled, because Seurat specific metadata is already existing.</p>
<div class="sourceCode" id="cb6"><html><body><pre class="r"><span class="no">pbmc3k</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/seuratFindClusters.html">seuratFindClusters</a></span>(<span class="kw">inSCE</span> <span class="kw">=</span> <span class="no">pbmc3k</span>,
                             <span class="kw">useAssay</span> <span class="kw">=</span> <span class="st">"seuratScaledData"</span>)
<span class="fu"><a href="../reference/plotSCEDimReduceColData.html">plotSCEDimReduceColData</a></span>(<span class="kw">inSCE</span> <span class="kw">=</span> <span class="no">pbmc3k</span>,
                        <span class="kw">colorBy</span> <span class="kw">=</span> <span class="st">"Seurat_louvain_Resolution0.8"</span>,
                        <span class="kw">conditionClass</span> <span class="kw">=</span> <span class="st">"factor"</span>,
                        <span class="kw">reducedDimName</span> <span class="kw">=</span> <span class="st">"seuratUMAP"</span>)</pre></body></html></div>
<p><img src="clustering_files/figure-html/clst_seurat1-1.png" width="700" style="display: block; margin: auto;"></p>
<p>When users preprocessed the dataset with other approaches. The clustering with Seurat function can be complicated, since some sorts of Seurat specific metadata is always needed.</p>
<div class="sourceCode" id="cb7"><html><body><pre class="r"><span class="co"># Let's get another totally independent dimension reduction for demonstration. </span>
<span class="no">pbmc3k</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/getPCA.html">getPCA</a></span>(<span class="no">pbmc3k</span>, <span class="kw">reducedDimName</span> <span class="kw">=</span> <span class="st">"PCA"</span>)
<span class="no">pca</span> <span class="kw">&lt;-</span> <span class="fu">reducedDim</span>(<span class="no">pbmc3k</span>, <span class="st">"PCA"</span>)
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(<span class="no">pca</span>) <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html">gsub</a></span>(<span class="st">"_"</span>, <span class="st">"-"</span>, <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(<span class="no">pca</span>))
<span class="kw">if</span> (<span class="st">"percentVar"</span> <span class="kw">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/attributes.html">attributes</a></span>(<span class="no">pca</span>))) {
    <span class="no">stdev</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/attr.html">attr</a></span>(<span class="no">pca</span>, <span class="st">"percentVar"</span>))
    <span class="no">new_pca</span> <span class="kw">&lt;-</span> <span class="kw pkg">Seurat</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/Seurat/man/CreateDimReducObject.html">CreateDimReducObject</a></span>(<span class="kw">embeddings</span> <span class="kw">=</span> <span class="no">pca</span>,
                                            <span class="kw">assay</span> <span class="kw">=</span> <span class="st">"RNA"</span>,
                                            <span class="kw">stdev</span> <span class="kw">=</span> <span class="no">stdev</span>,
                                            <span class="kw">key</span> <span class="kw">=</span> <span class="st">"PC_"</span>)
} <span class="kw">else</span> {
    <span class="no">new_pca</span> <span class="kw">&lt;-</span> <span class="kw pkg">Seurat</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/Seurat/man/CreateDimReducObject.html">CreateDimReducObject</a></span>(<span class="kw">embeddings</span> <span class="kw">=</span> <span class="no">pca</span>,
                                            <span class="kw">assay</span> <span class="kw">=</span> <span class="st">"RNA"</span>,
                                            <span class="kw">key</span> <span class="kw">=</span> <span class="st">"PC_"</span>)
}
<span class="co"># Then we can take the Seurat Curated Workflow independent dimension </span>
<span class="co"># reduction as an input. </span>
<span class="no">pbmc3k</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/seuratFindClusters.html">seuratFindClusters</a></span>(<span class="kw">inSCE</span> <span class="kw">=</span> <span class="no">pbmc3k</span>,
                             <span class="kw">useAssay</span> <span class="kw">=</span> <span class="fu">assayNames</span>(<span class="no">pbmc3k</span>)[<span class="fl">1</span>], <span class="co"># Need a placeholder</span>
                             <span class="kw">externalReduction</span> <span class="kw">=</span> <span class="no">new_pca</span>,
                             <span class="kw">resolution</span> <span class="kw">=</span> <span class="fl">0.8</span>)
<span class="fu"><a href="../reference/plotSCEDimReduceColData.html">plotSCEDimReduceColData</a></span>(<span class="kw">inSCE</span> <span class="kw">=</span> <span class="no">pbmc3k</span>,
                        <span class="kw">colorBy</span> <span class="kw">=</span> <span class="st">"Seurat_louvain_Resolution0.8"</span>,
                        <span class="kw">conditionClass</span> <span class="kw">=</span> <span class="st">"factor"</span>,
                        <span class="kw">reducedDimName</span> <span class="kw">=</span> <span class="st">"seuratUMAP"</span>)</pre></body></html></div>
<p><img src="clustering_files/figure-html/clst_seurat2-1.png" width="700" style="display: block; margin: auto;"></p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Joshua D. Campbell, David Jenkins, Tyler Faits, Mohammed Muzamil Khan, Zhe Wang, Emma Briars, Sebastian Carrasco Pro, W. Evan Johnson, Yusuke Koga, Shruthi Bandyadka, Anastasia Leshchyk, Rui Hong, Yichen Wang.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
